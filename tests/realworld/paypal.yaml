paypal-payment-test:
  environment: production
  url: https://osc2.oxid.shop
  timeout: 180
  jobs:
    - name: user-login
      prompt: Login to the shop with credentials redrobot@dantweb.dev and password useruser. Click login button, try to click it to get logged in
      acceptance:
        - user is logged in and sees the homepage with a paypal banner

    - name: add-products-to-cart
      prompt: Add 2 products to the shopping cart.
      acceptance:
        - first product is added to cart
        - second product is added to cart
        - cart has 2 items

    - name: open-cart-and-checkout
      prompt: Open the mini basket dropdown, verify the basket menu box is visible, then click the checkout button
      acceptance:
        - mini basket opens successfully
        - checkout page loads
        - user is on payment selection page

    - name: select-paypal-payment
      prompt: Select PayPal as the payment method
      acceptance:
        - PayPal payment method is selected

    - name: accept-terms-and-order
      prompt: Accept the terms and conditions by clicking the checkbox and click button to place an order
        - terms and conditions checkbox is checked
        - order button is clicked
        - order is submitted

    - name: verify-paypal-iframe
      prompt: Wait for the PayPal iframe to appear on the page. Look for iframe[title="PayPal"] or iframe[src*="paypal"]. The PayPal button inside the iframe needs to be clicked manually or by special handling. Wait 10 seconds for the PayPal popup to appear
      acceptance:
        - PayPal iframe is visible on page
        - iframe loads correctly
        - PayPal integration is working

    - name: paypal-popup-login
      prompt: This is a manual step or requires special popup handling. A PayPal popup window should open where you need to login with PayPal credentials. Fill in the email field #email, click next button #btnNext, fill in password field #password, click login button #btnLogin, then click the continue button. Wait 30 seconds for the user to complete this process
      acceptance:
        - PayPal popup window opens
        - user logs into PayPal
        - PayPal authorizes the payment
        - popup closes and returns to shop

    - name: verify-order-confirmation
      prompt: After PayPal authorization completes and the popup closes, wait for redirect back to the shop. Verify that the thank you page is displayed by checking for #thankyouPage or .thankyou element. Take a screenshot to confirm successful payment
      acceptance:
        - thank you page is displayed
        - order confirmation is visible
        - payment was successful
        - screenshot is captured
